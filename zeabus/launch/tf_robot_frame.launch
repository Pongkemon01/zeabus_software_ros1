<?xml version="1.0"?>

<!--
		Detail of this purpose
			01. Open IMU 1 component
			02. Open DVL 1 component
			03.	Open Robot Node 1 robot
			04. This file all use TF & Broadcaster to init frame and send a value
-->

<launch>

	<arg name="dvl_serialport" default="/dev/usb2serial/ftdi_FT2VR5PM_02"/>
	<arg name="microstrain_serial" default="/dev/microstrain/3dm_gx5_45_0000__6251.65903"/>
	<arg name="world_frame" default="world"/>
	<arg name="robot_frame" default="robot"/>
	<arg name="imu_frame" default="imu"/>
	<arg name="imu_topic" default="/sensor/imu"/>
	<arg name="dvl_frame" default="dvl"/>
	<arg name="PI" default="3.14159265"/>
	<arg name="HalfPI" default="1.570796325"/>
	<arg name="NegateHalfPI" default="-1.570796325"/>

	<node name="imu" output="screen" pkg="zeabus_sensor" type="tf_imu">
		<param name="port_imu" value="$(arg microstrain_serial)"/>
		<param name="publish_topic" type="str" value="$(arg imu_topic)"/>
		<param name="subscribe_topic" type="str" value="/test/imu"/>
		<param name="parent_id" type="str" value="$(arg robot_frame)"/>
		<param name="frame_id" type="str" value="$(arg imu_frame)"/>
		<param name="rotation_x" type="double" value="$(arg PI)"/>
		<param name="rotation_y" type="double" value="0.0"/>
		<param name="rotation_z" type="double" value="$(arg HalfPI)"/>
		<param name="translation_x" type="double" value="0.0"/>
		<param name="translation_y" type="double" value="0.0"/>
		<param name="translation_z" type="double" value="0.0"/>
		<param name="use_offset" type="bool" value="true"/>
		<param name="offset_roll" type="double" value="$(arg PI)"/>
		<param name="offset_pitch" type="double" value="0.0"/>
		<param name="offset_yaw" type="double" value="$(arg HalfPI)"/>
		<param name="frequency" type="int" value="50"/>
	</node>

	<node name="dvl" output="screen" pkg="zeabus_sensor" type="tf_dvl">
		<param name="port_dvl" value="$(arg microstrain_serial)"/>
		<param name="publish_topic" type="str" value="/sensor/dvl"/>
		<param name="subscribe_topic" type="str" value="/test/dvl"/>
		<param name="parent_id" type="str" value="$(arg robot_frame)"/>
		<param name="frame_id" type="str" value="$(arg dvl_frame)"/>
		<param name="rotation_x" type="double" value="0.0"/>
		<param name="rotation_y" type="double" value="0.0"/>
		<param name="rotation_z" type="double" value="0.0"/>
		<param name="translation_x" type="double" value="0.0"/>
		<param name="translation_y" type="double" value="0.0"/>
		<param name="translation_z" type="double" value="0.0"/>
		<param name="raw_topic" type="str" value="/raw/dvl"/>
	</node>

	<node name="robot" output="screen" pkg="zeabus_sensor" type="tf_robot">
		<param name="parent_id" type="str" value="$(arg world_frame)"/>
		<param name="frame_id" type="str" value="$(arg robot_frame)"/>
		<param name="imu_id" type="str" value="$(arg imu_frame)"/>
		<param name="subscribe_imu" type="str" value="$(arg imu_topic)"/>
		<param name="subscribe_state" type="str" value="/localize/state"/>
		<param name="publish_topic" type="str" value="/sensor/robot"/>
	</node>
</launch>
